paths:
  /api/sessions/register:
    post:
      tags: [Auth]
      summary: Registrar usuario
      description: Crea un usuario nuevo. No permite asignar rol admin desde esta ruta.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                firstName:
                  type: string
                  example: Maxi
                lastName:
                  type: string
                  example: Admin
                email:
                  type: string
                  format: email
                  example: maxi.dev@example.com
                password:
                  type: string
                  format: password
                  example: Newword123!
              required: [firstName, lastName, email, password]
      responses:
        '201':
          description: Usuario creado
        '400':
          description: Datos inválidos o email duplicado
        '403':
          description: CSRF inválido
        '500':
          description: Error interno
      security:
        - csrfHeader: []
  /api/sessions/login:
    post:
      tags: [Auth]
      summary: Iniciar sesión
      description: Inicia sesión del usuario y setea cookie httpOnly
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  example: maxi@example.com
                password:
                  type: string
                  example: Admin$12345
              required: [email, password]
      responses:
        '200':
          description: Sesión iniciada
        '401':
          description: Credenciales inválidas
        '403':
          description: CSRF inválido
        '500':
          description: Error interno
      security:
        - csrfHeader: []
  /api/sessions/logout:
    post:
      tags: [Auth]
      summary: Cerrar sesión
      responses:
        '204':
          description: Sesión cerrada
      security:
        - csrfHeader: []
  /api/sessions/current:
    get:
      tags: [Auth]
      summary: Usuario actual
      responses:
        '200':
          description: Información del usuario
      security:
        - csrfHeader: []
